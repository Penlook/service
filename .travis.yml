language: go

go:
  - 1.4

services:
  - redis-server
  - cassandra
  - mongodb
  - rabbitmq

env:
  - AMQP_URL=amqp://guest:guest@127.0.0.1:5672/ GOMAXPROCS=2

install:
  - go get -v ./...
  - go get github.com/stretchr/testify/assert
  - export PATH=$PATH:$HOME/gopath/bin

before_script:
  - mysql -e 'create database test;'

script:
  - ./service.sh api stop build start test